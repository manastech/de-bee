{% extends "master.html" %}
{% block top %} 
	<div style="text-align: right"> 
	<font size="5">{{currentUser.nickname}}</font><br>  
	(<a href="{{signout_url}}">sign out</a>)
	</div>
{% endblock %}
{% block navigation %}
	<div id="menuGroupsActive">
		
	</div>
	<div id="menuHome">
		<a href="/">
			<span/>
		</a>
	</div>
{% endblock %}
{% block content %}
		{{ message }}
		<div style="float: right">
			<form action="/group" method="get">
				Group:
				<select name="group" onchange="form.submit();">
					<option>-- select another group --</option>
				{% for group in groups %}
				<option value="{{ group.key }}">{{ group.name }}</option>
				{% endfor %}
				</select>
			</form>
		</div>
		<h3>Group {{ group.name }}</h3>
		
		<div style="margin-bottom: 40px;">
			<a href="javascript:showGroupTab('groupHome')" {% if goToHistoryTab %}{%else%}class="active"{%endif%} id="buttonGroupHome"></a>
			<a href="javascript:showGroupTab('groupInvite')" id="buttonGroupInvite"></a>
			<a href="javascript:showGroupTab('groupHistory')" {% if goToHistoryTab %}class="active"{%endif%} id="buttonGroupHistory"></a>
		</div>
		<h3>&nbsp;</h3>

		{% if goToHistoryTab %}
		<div id="groupHome" style="display:none">
		{% else %}
		<div id="groupHome">
		{% endif %}
		
		<h3>Your balance</h3>
	
		{% if balanceIsZero %}
			You owe nobody, and nobody owes you. Hurray!
		{% else %}
			{% if balancePositive %}
				{% include "groupDetailPositive.html" %}
			{% else %}
				{% include "groupDetailNegative.html" %}
			{% endif %}
		{% endif %}
		
		<h3>Actions</h3>
	
		{% include "enterTransaction.html" %}
		
		<p>
		{% if balanceIsZero %}
			<form action="/groupUnsubscription" method="post">
				<input type="hidden" name="group" value="{{group.key}}" />
				<input type="submit" value="Unregister me!" />
			</form>
		{% else %}
			<small>To unsubscribe from this group you must first pay your debts.</small>
		{% endif %}
		</p>
		</div>
		
		<div id="groupInvite" style="display:none">
			{% include "enterInvite.html" %}
		</div>
		
		{% if goToHistoryTab %}
		<div id="groupHistory">
		{% else %}
		<div id="groupHistory" style="display:none">
		{% endif %}
			<h3>History</h3>
			
			{% include "transactionHistory.html" %}
		</div>
		
		<script>
		function showGroupTab(id) {
			document.getElementById("groupHome").style.display = "none";
			document.getElementById("groupInvite").style.display = "none";
			document.getElementById("groupHistory").style.display = "none";
			document.getElementById("buttonGroupHome").className = "";
			document.getElementById("buttonGroupInvite").className = "";
			document.getElementById("buttonGroupHistory").className = "";
			document.getElementById(id).style.display = "";

			switch (id)
			{
				case 'groupHome': document.getElementById("buttonGroupHome").className = "active"; break;
				case 'groupInvite': document.getElementById("buttonGroupInvite").className = "active"; break;
				case 'groupHistory': document.getElementById("buttonGroupHistory").className = "active"; break;
			}
		}
		</script>
		
{% endblock %}
